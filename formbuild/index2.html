<!doctype html>

<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>Bootstrap 3 Form Builder</title>
	<link rel="stylesheet" href="css/jquery.ui.theme.css" />
	<link rel="stylesheet" href="css/bootstrap.css" />
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery.ui.min.js"></script>
	<script src="js/bootstrap.js"></script>
	<script src="js/beautifyhtml.js"></script>
	 <style>
    #tables li,
    #tables li label {
      cursor: pointer;
    }
    
    #tables ul li {
      cursor: grab;
      margin-left: 30px;
      color: red
    }
  </style>
	<style>
		.droppable-active {
			background-color: #ffe !important;
		}

		.tools a {
			cursor: pointer;
			font-size: 80%;
		}

		.form-body .col-md-6,
		.form-body .col-md-12 {
			min-height: 400px;
		}

		.draggable {
			cursor: move;
		}
	</style>
	<script>
		$(document).ready(function () {
			setup_draggable();

			$("#n-columns").on("change", function () {
				var v = $(this).val();
				if (v === "1") {
					var $col = $('.form-body .col-md-12').toggle(true);
					$('.form-body .col-md-6 .draggable').each(function (i, el) {
						$(this).remove().appendTo($col);
					})
					$('.form-body .col-md-6').toggle(false);
				} else {
					var $col = $('.form-body .col-md-6').toggle(true);
					$(".form-body .col-md-12 .draggable").each(function (i, el) {
						$(this).remove().appendTo(i % 2 ? $col[1] : $col[0]);
					});
					$('.form-body .col-md-12').toggle(false);
				}
			});


			$("#toggle-drop").on("click", function () {
				if (!$("#drop-area").hasClass("form-body"))
					$("#drop-area").removeClass("form-body");
				else
					$("#drop-area").addClass("form-body");
			});
			$("#copy-to-clipboard").on("click", function () {
				var $copy = $(".form-body").parent().clone().appendTo(document.body);
				$copy.find(".tools, :hidden").remove();
				$.each(["draggable", "droppable", "sortable", "dropped",
					"ui-sortable", "ui-draggable", "ui-droppable", "form-body"], function (i, c) {
						$copy.find("." + c).removeClass(c);
					})
				var html = html_beautify($copy.html());
				$copy.remove();

				$modal = get_modal(html).modal("show");
				$modal.find(".btn").remove();
				$modal.find(".modal-title").html("Copy HTML");
				$modal.find(":input:first").select().focus();

				return false;
			})


		});

		var setup_draggable = function () {
			$(".draggable").draggable({
				appendTo: "body",
				helper: "clone"
			});
			$(".droppable").droppable({
				accept: ".draggable",
				helper: "clone",
				hoverClass: "droppable-active",
				drop: function (event, ui) {
					$(".empty-form").remove();
					var $orig = $(ui.draggable)
					if (!$(ui.draggable).hasClass("dropped")) {
						var $el = $orig
							.clone()
							.addClass("dropped")
							.css({ "position": "static", "left": null, "right": null })
							.appendTo(this);

						// update id
						var id = $orig.find(":input").attr("id");

						if (id) {
							id = id.split("-").slice(0, -1).join("-") + "-"
								+ (parseInt(id.split("-").slice(-1)[0]) + 1)

							$orig.find(":input").attr("id", id);
							$orig.find("label").attr("for", id);
						}

						// tools
						$('<p class="tools">\
						<a class="edit-link">Edit HTML<a> | \
						<a class="remove-link">Remove</a></p>').appendTo($el);
					} else {
						if ($(this)[0] != $orig.parent()[0]) {
							var $el = $orig
								.clone()
								.css({ "position": "static", "left": null, "right": null })
								.appendTo(this);
							$orig.remove();
						}
					}
				}
			}).sortable();

		}

		var get_modal = function (content) {
			var modal = $('<div class="modal" style="overflow: auto;" tabindex="-1">\
			<div class="modal-dialog">\
				<div class="modal-content">\
					<div class="modal-header">\
						<a type="button" class="close"\
							data-dismiss="modal" aria-hidden="true">&times;</a>\
						<h4 class="modal-title">Edit HTML</h4>\
					</div>\
					<div class="modal-body ui-front">\
						<textarea class="form-control" \
							style="min-height: 200px; margin-bottom: 10px;\
							font-family: Monaco, Fixed">'+ content + '</textarea>\
						<button class="btn btn-success">Update</button>\
					</div>\
				</div>\
			</div>\
			</div>').appendTo(document.body);

			return modal;
		};

		$(document).on("click", ".edit-link", function (ev) {
			var $el = $(this).parent().parent();
			var $el_copy = $el.clone();

			var $edit_btn = $el_copy.find(".edit-link").parent().remove();

			var $modal = get_modal(html_beautify($el_copy.html())).modal("show");
			$modal.find(":input:first").focus();
			$modal.find(".btn-success").click(function (ev2) {
				var html = $modal.find("textarea").val();
				if (!html) {
					$el.remove();
				} else {
					$el.html(html);
					$edit_btn.appendTo($el);
				}
				$modal.modal("hide");
				return false;
			})
		});

		$(document).on("click", ".remove-link", function (ev) {
			$(this).parent().parent().remove();
		});
	</script>
	<script>
		    tables = [{
      "name": "students",
      "fields": {
        "firstName": "char",
        "lastName": "char",
        "DOB": "date",
        "address": "char",
        "fee": "dec",
        "age": "num"
      }
    },
    {
      "name": "teachers",
      "fields": {
        "firstName": "char",
        "lastName": "char",
        "DOB": "date",
        "address": "char",
        "fee": "dec",
        "age": "num",
        "class": "char"
      }
    }
    ];
		 $(document).ready(function () {

      for (var i = 0; i < tables.length; i++) {
        var $file = $("<li/>");
        $($file).append('<label class="tree-toggler nav-header">' + tables[i].name + '</label>');
        var $fields = $("<ul/>").addClass("nav nav-list tree");
        for (var x in tables[i].fields) {
          $($fields).append('<li draggable="true"  ondragstart="drag(event)" >' + x  + '</li>');
        }
        $($file).append($fields);
        $("#tables").append($file);
      }

      $('label.tree-toggler').click(function () {
        $(this).parent().children('ul.tree').toggle(300);
      });
      $('label.tree-toggler').parent().children('ul.tree').toggle(1);


    });

	function allowDrop(ev) {
    ev.preventDefault();
}
    function drop(ev){
       ev.preventDefault();       
      var data = ev.dataTransfer.getData("text");
      console.log(data);
      if (ev.target.tagName=='INPUT'){
          ev.target.setAttribute('name',data);
          ev.target.setAttribute('placeholder',splitCamelCase(data));
          ev.target.id=data;
          ev.target.parentNode.parentNode.getElementsByTagName("label")[0].innerHTML=splitCamelCase(data);
      }
      //console.log(ev.target.firstChild.innerHTML);
      //ev.target.innerHTML='Active User';//parentNode.firstChild.innerHTML = "Milk"
     // document.getElementById("label1").innerHTML="Milk treak";

    }
    function drag(ev) {
    ev.dataTransfer.setData("text", ev.target.innerHTML);
   }

   /**
 * Splits a camelCase or PascalCase word into individual words separated by spaces. 
 * @param {Object} word
 * @returns {String}
 */
 console.log(splitCamelCase('thisIsImportant'));
function splitCamelCase(word) {
	var output, i, l, capRe = /[A-Z]/;
	if (typeof(word) !== "string") {
		throw new Error("The \"word\" parameter must be a string.");
	}
	output = [];
	for (i = 0, l = word.length; i < l; i += 1) {
		if (i === 0) {
			output.push(word[i].toUpperCase());
		}
		else {
			if (i > 0 && capRe.test(word[i])) {
				output.push(" ");
			}
			output.push(word[i]);
		}
	}
	return output.join("");
}
	</script>	
</head>

<body style="background-color: #ddd;">
	<nav class="navbar navbar-default navbar-fixed" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<a class="navbar-brand" href="#">Bootstrap 3 Form Builder</a>
		</div>
		<form class="navbar-form navbar-left">
			<div class="form-group">
				<select class="form-control" id="n-columns">
				<option value="1">1 Column</option>
				<option value="2">2 Columns</option>
			</select>
			</div>
			<button type="submit" class="btn btn-primary" data-clipboard-text="testing" id="copy-to-clipboard">Copy HTML</button>
			<button class="btn btn-primary" data-clipboard-text="toggle" id="toggle-drop">Toggle Form Dropable</button>
		</form>
	</nav>
	<div style="margin-top: -20px;">
		<div class="row">
			<div class="col-md-3" style="padding: 0px 30px 30px 30px; background-color: #fff; ">
				<h3>Elements</h3>
				<form role="form">


					<div class="form-group draggable">
						<label class="control-label" for="input-file-1">File input</label>
						<input type="file" id="input-file-1">
						<p class="help-block">Example block-level help text here.</p>
					</div>
					<div class="checkbox draggable">
						<label>
						<input type="checkbox"> <span >Check me out</span>
					</label>
					</div>
					<div class="form-group draggable" style="padding-right: 20px;">
						<button type="submit" class="btn btn-default">Submit</button>
					</div>
					<div class="form-group draggable">
						<label class="col-sm-6 control-label" for="textinput">Date</label>
						<div class="col-sm-6 control-group">
							<div class="controls">
								<div class="input-prepend input-group">
									<span class="add-on input-group-addon"><i class="glyphicon glyphicon-calendar fa fa-calendar"></i></span>
									<input type="text" name="date1" id="date1" class="form-control" value="01/01/2016 " />
								</div>
							</div>
						</div>
					</div>
					<br><br>
					<div class="form-group draggable">
						<label class="col-sm-6 control-label" for="textinput">Static Text Label</label>
						<p class="col-sm-6 form-control-static"> Static text</p>
					</div><br><br>
					<div class="form-group draggable " ondrop="drop(event)"  ondragover="allowDrop(event)">
						<label class="col-sm-6 control-label" for="textinput">Text Input</label>
						<div class="col-sm-6">
							<input id="textinput" name="textinput" placeholder="placeholder" class="form-control input-md" type="text">

						</div>
					</div>

					<div class="form-group draggable">
						<label class="col-sm-6 control-label" for="textinput">Password</label>
						<div class="col-sm-6">
							<input id="pwd" type="password" name="password" placeholder="Password" class="form-control input-md" type="text">

						</div>
					</div>

					<div class=" draggable">
						<div class="row">
							<div class="col-md-4  droppable sortable" style="min-height: 100px;">col1</div>
							<div class="col-md-4 droppable sortable" style="min-height: 100px;">col1</div>
							<div class="col-md-4 droppable sortable" style="min-height: 100px;">col3</div>
						</div>
					</div>

					<div class="form-group draggable">
						<label class="col-sm-6 control-label" for="select1">Select</label>
						<div class="col-sm-6 inline ">
							<select class="form-control" id="select1">                            
                            <option value="Option 1">Option one</option>
                            <option value="Option 1">Option two</option>
                            <option value="Option 1">Option three</option>                           
                          </select>

						</div>
					</div>

					<div class="form-group draggable">
						<img src="user.png" class="img-thumbnail" alt="Image" width="50" height="50">
					</div>
					<div class="form-group draggable">
						<label class="control-label col-md-3 col-sm-3 col-xs-12">Check Box</label>
						<label class="checkbox-inline"><input type="checkbox" name="checkbox1" value="1">Option 1</label>
						<label class="checkbox-inline"><input type="checkbox" name="checkbox1" value="2">Option 2</label>
						<label class="checkbox-inline"><input type="checkbox" name="checkbox1" value="3">Option 3</label>
					</div><br>
					<div class="form-group draggable">
						<label class="control-label col-md-3 col-sm-3 col-xs-12">Radio Button</label>
						<label class="radio-inline"><input type="radio" name="optradio">Option 1</label>
						<label class="radio-inline"><input type="radio" name="optradio">Option 2</label>
						<label class="radio-inline"><input type="radio" name="optradio">Option 3</label>
					</div>
					<div class="form-group draggable">
						<div class="x_panel">
							<div class="x_content">

								<table id="datatable" class="table table-striped table-bordered">
									<thead>
										<tr>
											<th>ID</th>
											<th>First Name</th>
											<th>Last Name</th>
										</tr>
									</thead>


									<tbody>

										<tr>
											<td>20150125</td>
											<td>Carl</td>
											<td>Brooks</td>
										</tr>
										<tr>
											<td>20150165</td>
											<td>Oniel</td>
											<td>Charles</td>
										</tr>
										<tr>
											<td>20150225</td>
											<td>Donna</td>
											<td>Anderson</td>
										</tr>


									</tbody>
								</table>
							</div>
						</div>
					</div>

				</form>
			</div>
			<div class="col-md-7" style="padding: 30px;">
				<div style="background-color: #fff; border-radius: 5px; padding: 20px; 
						box-shadow: 0 6px 12px rgba(0, 0, 0, 0.175); ">
					<div class="text-muted empty-form text-center" style="font-size: 24px;">Drag & Drop elements to build form.</div>
					<div class="row form-body" id="drop-area">
						<div class="col-md-12 droppable sortable">

						</div>
						<div class="col-md-6 droppable sortable" style="display: none;">
						</div>
						<div class="col-md-6 droppable sortable" style="display: none;">
						</div>
					</div>
					<div class=" draggable">
						<div class="row">
							<div class="col-md-4  droppable sortable" style="min-height: 100px;">col4</div>
							<div class="col-md-4 droppable sortable" style="min-height: 100px;">col4</div>
							<div class="col-md-4 droppable sortable" style="min-height: 100px;">col4</div>
						</div>
					</div>
					<div class=" draggable">
						<div class="row">
							<div class="col-md-6  droppable sortable" style="min-height: 100px;">col6</div>
							<div class="col-md-6 droppable sortable" style="min-height: 100px;">col6</div>
						</div>
					</div>
					<div class=" draggable">
						<div class="row">
							<div class="col-md-12 droppable sortable" style="min-height: 100px;">col12</div>
						</div>
					</div>
				</div>
			</div>
            <div class="col-md-2 ">
				hi
				<ul id=tables class="nav nav-list">
				</ul>
			</div>
			
		</div>
		
	</div>

</body>

</html>